Метод Сплайн-Коллокации
Дискретизация диффура
Преимущество - использование сплайна

---
Пусть есть задача
$$
Lu=f, x \in [a,b]
$$
$$
Lu\big|_{x=\xi_{k}} = f(\xi_{k})
$$
ищем решение в виде: $\Phi(x,c)$ - заданая функция с параметрами, а также:
$$
\sum_{i=1}^n a_{i}\phi_{i}
$$
---
Первая работы : Сплайны Шёнберга (Кубические сплайны класса $S(x)\in C^2$)

---
$$
\begin{cases}
L[y(x)] = y''(x) + p(x)y'(x) + q(x)y(x) = r(x), x \in [a,b]  \\
\alpha_{1}y(x) + \beta_{1}y'(a)=\gamma_{1} \\
\alpha_{2}y(b) + \beta_{2}y'(b) = \gamma_{2}
\end{cases}

$$
Введём сетку $\Delta: a = x_{0} < x_{1} < \dots < x_{N} = b$ - Сетка для построения кубического сплайна $C^2$
Потребуем, чтобы сплайн удовлетворял нашему уравнению в узлах колокации
$$
\begin{cases}
L[S(\xi_{k})] = S''(\xi_{k}) + p(\xi_{k})S'(\xi_{k}) + q(\xi_{k})S(\xi_{k}) = r(\xi_{k}), \xi_{k} \in [a,b] \\
\alpha_{1}S(a) + \beta_{1}S'(a) = \gamma_{1} \\
\alpha_{2}S(b) + \beta_{2}(b)S'(b) =\gamma_{2}
\end{cases}
$$
Первое ура - условие колокации
Размерность пространства $S(x)\in C^2$ = $N+3$
$$
\xi_{k}, \ k = 0, \dots, N
$$
Выбор узлов колокации 
	не стоит брать в разрыве (особенность)
	максимум 3 узла на подотрезке, иначе сплайн замкнётся на отрезке
	Лучше выбрать  $\xi_{k} = x_{k}$
На равномерной или нет получится разный результат (погрешности)

---
Рассмотрим случай, когда $\xi_{k} = x_{k}$
$$
p(x)\equiv0, S(x_{i}) = u_{i}, S''(x_{i}) = M_{i}
$$
$$
M_{i} + q_{i}u_{i} = r(x_{i}), \ i = 0, \dots ,N
$$

$$
\mu_{i}M_{i-1} + 2M_{i} + \lambda_{i}M_{i+1} = \frac{6}{h_{i-1} + h_{i+1}} \left( \frac{u_{i+1} - u_{i}}{h_{i}} - \frac{u_{i} - u_{i-1}}{h_{i-1}} \right), i = 0, \dots ,N-1
$$
$$
\mu_{i} = \frac{h_{i}}{h_{i} + h_{i-1}}, \ \lambda_{i} = 1 - \mu_{i}
$$
Выражаем следующие
$$
M_{i} = r_{i} - q_{i}u_{i}
$$
и подставляем в выражение выше
$$
S(x) = u_{i}(1-t) + u_{i+1}t - \frac{h_{i}^2}{6}t(1-t)[(2-t)M_{i} + (1+t)M_{i+1}], \ h_{i} = x_{i+1}  - x_{i},  \ t = \frac{x-x_{i}}{h_{i}}$$
$$
S'(x) = \frac{u_{i+1} - u_{i}}{h_{i}} - \frac{h_{i}}{6}[(2-6t+3t^2)M_{i}+(1-3t^2)M_{i+1}]
$$
---
$$
\lambda_{i}\left( 1 + \frac{h_{i-1}^2}{6}q_{i-1} \right)u_{i-1} - \left( 1 - \frac{h_{i}h_{i-1}}{3}q_{i} \right)u_{i} + \mu_{i}\left( 1+ \frac{h_{i}^2}{6}q_{i+1} \right) u_{i+1}= \left( \frac{h_{i}h_{i-1}}{6} \right) (\mu_{i}r_{i-1} + 2r_{i} + \lambda_{i}r_{i+1}), i = 0, \dots N-1
$$
$$
\alpha_{1}S(x_{0}) + \beta_{1}S'(x_{0}) = \gamma_{1}
$$

$$
|1-\frac{h_{i}h_{i-1}}{3}q_{i}| - \lambda_{i}|1 + \frac{h^2_{i-1}}{6}q_{i-1}| - \mu_{i}|1+\frac{h^2_{i}}{6}q_{i+1}|>0
$$
Условие диаг преобл получаем следующее
$$
\begin{cases}
h^2_{i-1}max\{|q_{i-1}|,|q_{i}|\} \le {6},\ i = 1, \dots, N  \\
q(x) \le q < 0, \\
\beta_{1} \le 0 \\
|\alpha_{i}| + |\beta_{i}| \ne 0, i = 1 ,2 \\
\beta_{2}, \alpha_{j} \ge 0
\end{cases}
$$

Получаем систему и решаем методом монотонной прогонки 

---
### Теорема о сходимости (общая для любых разбиений)
Пусть в нашей задаче выполнены условия
$$
\begin{cases}
h^2_{i-1}max\{|q_{i-1}|,|1_{i}|\} \le {6},\ i = 1, \dots, N  \\
q(x) \le q < 0, \\
\beta_{1} \le 0 \\
|\alpha_{i}| + |\beta_{i}| \ne 0, i = 1 ,2 \\
\beta_{2}, \alpha_{j} \ge 0, \\
p(x)\equiv 0
\end{cases}
$$
Если точное решение принадлежит классу $y(x) \in C^2 W^4_{\Delta, \infty}[a,b]$, тогда норма разности
$$
||S(x) - y(x)||_{C} = O(\overline{h}^2), \overline{h} = max_{i} h_{i}
$$
$$
\begin{cases}
y(x) \in C^2 [a,b]  \\
y(x) \in W^4_{\infty}[x_{i}, x_{i+1}]
\end{cases}
$$
w = 3 производные непрерывные, квадрат 4-ой интегрируем.
Для доказательства вводится интерполяционный сплайн $S(x) - y(x) \pm S_{c}(x)$
$$
|S(x) - S_{c}(x)| + |S_{c}(x) - y(x)| \le
$$
Второе слагаемое O(h^4), так что работа только с первым. Правая часть = оценки 

---
$p(x) > 0$
Рассмотрим разложение по базису 
B-сплайны
$$
S(x) = \sum_{i=-1}^{N+1} b_{i}B_{i}(x)
$$
Для N+3 смещение по i
Выбираются системы сплайнов так, чтобы площадь подграфика = 1 (условие нормировки)
Используются нормализованные кубические B-сплайны.
$x_{i} = \xi_{i}$