### Методы решения обыкновенных дифур
---
При решении диффура мы получаем общее решение (с константами). если есть условия, то получаем частное решение.

#### Задача Коши

$y' = f(x,y),x \in [x_0, x-0 + X]$
$(CP)\begin{cases} y'=f(x,y) \\ y(x_0) = y_0 \end{cases}$


#### Краевые задачи 
Условия на концах рассматриваемого отрезка
$y''(x) + p(x)y'(x) + q(x)y(x) = f(x), \ x \in [a,b]$
Смешанное уловие 
$\begin{cases}\alpha_1 y(a) + \beta_1 y'(a) = \gamma_1 \\ \alpha_2 y(b) + \beta_2 y'(b) = \gamma_2 \end{cases}$
- задача Неймана - При заданных на концах первые производные 
- Задача Дирихле при заданных значениях функции на концах отрезка
Разностный метод (разностная схема) [link to next lecture]
---
$y' = f(x,y), \ y(x_0) = y_0, x \in [x_0, x_0 + X]$
##### Простой подход - формула Тейлора ([[Брук Тейлор]]):
$y(x) \rightarrow y(x+h)$
$y(x+h) = y(x) + hy'(x) + \cancel{\frac{h^2}{2}y''(x) + \dots}$
Отбрасываем O(h^2)
$y(x+h) = y(x) + hf(x,y) + O(h^2)$ - Формула Эйлера( [[Леонард Эйлер]])

---
Решение
$y(x+h) = y(x) + \int_x^{x+h}f(x,y)dx$ - Точность первого порядка
Для улучшения точности слудует аппроксимировать по формуле трапеций [link to note]

$y(x+h) = y(x) + \frac{h}{2} (y'(x) + y'(x+h)) + O(h^3)$ - при замене на f(x,y) - получаем пример формулы Адамаса

[Формулы Адамса](https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%90%D0%B4%D0%B0%D0%BC%D1%81%D0%B0)

---
$y^* = y(x) + hf(x,y)$
$y(x+h) = y(x) + \frac{h}{2} (y'(x) + f(x+h)y(x+h)) + O(h^3)$ => $(f(x+h), y^*)$ - вторая часть в скобках

---
### [Формулы Рунге-Кутта](https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%A0%D1%83%D0%BD%D0%B3%D0%B5_%E2%80%94_%D0%9A%D1%83%D1%82%D1%82%D1%8B)
Пусть есть константы
$\alpha_2, \alpha_3, \dots , \alpha_q, p_1, p_2 ... p_1, \beta_{ij}, 0 < j<i<q$
$k_1(h) = hf(x,y)$
$k_2(h) = hf(x+\alpha_2h, y+\beta_2k_1(h))$
...
$k_q(h) = hf(x+\alpha_qh, y+\beta_{q1}k_1(h) + \dots + \beta_{q, q-1}k_{q-1}(h))$
$y(x+h) \approx y(x) + \sum_{i=1}^q p_ik_i(h) = z(h)$
Пусть будем считать, что функции достаточно гладки (есть достаточно производных)

$y(x+h) = z(h)$
$\phi(h) = y(x+h) - z(h)$

Пусть у $\phi$ есть производная, нужного нам порядка
$\phi'(h), \phi''(x), \dots, \phi^{(s)}(h), \phi^{(s+1)(h)}$ - для выбора констант
$\phi^{(i)}(0) = 0, i < s, \phi^{(s+1)}(0) \ne 0$
$\phi(h) = \sum_{i=1}^{s} \frac{\phi^{(i)}()0}{i!}h^i + \frac{\phi^{(s+1)}(\Theta)}{(s+1)!} h^{s+1}$ =>$\phi(h) = O(h^{s+1})$ - т.к. производные порядка до s = 0

---
#### Пример
$q = 1$
$\phi(h) = y(x+h) - y(x) - p_1hf(x,y), \phi(0) = 0$
$\phi'(h) = y'(x+h) - p_1f(x,y), \phi'(0) = y'(x) - p_1f(x,y) = f(x,y) (1-p_1) = 0 \Rightarrow p_1=1$
$\phi''(h) = y''(x+h), \phi''(0) = y''(x)$
Получаем формулу:
$y(x+h) = y(x) - hf(x,y)$ - Формула Эйлера ([[Леонард Эйлер]])

$q= 2$
$\phi(h) = y(x+h) - y(x) - p_1k_1(h) - p_2k_2(h)$
Проблемы плана трудоёмкости
![[Pasted image 20250225131150.png]]

q=4
$\begin{cases}k_1 = hf(x,y),\\ k_2 = hf(x+\frac{h}{2}, y + \frac{k_1}{2}),\\ k_3=hf(x+\frac{h}{2}, y+\frac{k_2}{2}), \\k_4 = hf(x+h, y+k_3)\end{cases}$
$y(x+h) = y(x) + \frac{1}{6}(k_1+ 2k_2 + 2k_3 + k4)$



---
Пусть погрешность на n шаге = $|R_n|$
$R_n = y(x_n) - y_n$
$|R_n| \le e^{MX}[ch^qX + N\epsilon + |R_0|], n \le N$
1) Погрешность метода [link]
2) Машинная погрешность[link]
3) Погрешность измерений[link]
